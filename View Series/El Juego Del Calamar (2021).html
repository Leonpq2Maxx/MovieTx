<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>MovieTx - Reproductor De Serie</title>
<!-- Responsive viewport -->
<meta content='width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0' name='viewport'/>
<link rel="stylesheet" href="https://cdn.plyr.io/3.6.12/plyr.css"/>

<style>
  .container .main-video{background:#000000;border-radius:5px;padding:0px;}
  .container .main-video video{width:100%;border-radius:5px;}
  .container .main-video .title{
  color:#fff;font-size:23px;padding-top:15px;padding-bottom:15px;}
    .container .video-list{
  background:#151515;border-radius:5px;height:317px;overflow-y:scroll;}
  .container .video-list::-webkit-scrollbar{
  width:7px;}
  .container .video-list::-webkit-scrollbar-track{
  background:#000;border-radius:50px;}
  .container .video-list::-webkit-scrollbar-thumb{
  background:#00a7ad;border-radius:50px;}
  .container .video-list .vid video{
  width:100px;border-radius:5px;}
  .container .video-list .vid{
  background:#000;display:flex;align-items:center;gap:15px;border-radius:5px;margin:10px;padding:10px;border:1px solid rgba(0,0,0,.1);cursor:pointer;}
  .container .video-list .vid:hover{
  background:#000;}
  .container .video-list .vid.active{
  background:#00a7ad;}
  .container .video-list .vid.active .title{
  color:#ff0000;}
  .container .video-list .vid .title{
  color:#fff;font-size:17px;}
    :root {
      --plyr-color-main: #ff0000;
      --plyr-video-control-color: #0022ff;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      outline: none;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
    }
    body {
      background-color: #000;
      font-family: 'PT Sans', sans-serif;
      color: #fff;
    }
    .player video {
      width: 100%;
      height: auto;
      border-radius: 8px;
    }
    .info {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: center;
      padding: 10px;
      border: 1px solid rgba(16, 235, 255, 0.461);
      border-radius: 10px;
      margin: 10px;
      font-size: 14px;
    }
    .info i {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .hd-tag {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .hd-tag svg {
      border-radius: 4px;
    }
    .titulo, .sinopsis {
      padding: 10px;
    }
    .titulo h3, .titulo h4, .sinopsis h4 {
      font-family: 'Kanit', sans-serif;
      margin-bottom: 5px;
    }
    .recomendaciones {
      padding: 10px;
    }
    .series-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      text-align: center;
    }
    .serie {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-decoration: none;
      color: white;
    }
    .serie img {
      width: 100%;
      max-width: 150px;
      border-radius: 10px;
    }
    .serie p {
      margin-top: 5px;
    }

    html { font-size: 100%; }
    body { font-size: 1rem; }
    h1 { font-size: 2rem; }
    h2 { font-size: 1.5rem; }
    h3, h4 { font-size: 1.2rem; }

    @media screen and (max-width: 768px) {
      body { font-size: 1.05rem; }
      h1 { font-size: 1.5rem; }
      h2 { font-size: 1.3rem; }
      h3, h4 { font-size: 1.1rem; }
      .info, .sinopsis p, .serie p {
        font-size: 1rem !important;
      }
    }

    @media screen and (max-width: 480px) {
      body { font-size: 1.1rem; }
      h1 { font-size: 1.4rem; }
      h2 { font-size: 1.2rem; }
      h3, h4 { font-size: 1rem; }
    }

    body, p, h1, h2, h3, h4, h5, h6, span, a, .titulo, .sinopsis, .recomendaciones, .serie {
      font-style: italic;
    }

    .info, .info *, .info span, .info i {
      font-style: normal !important;
    }

    #resume-msg {
      display: none;
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.85);
      padding: 10px 20px;
      color: #0f0;
      border-radius: 8px;
      z-index: 9999;
      font-weight: bold;
      max-width: 90%;
      font-size: 1rem;
      text-align: center;
      box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
      opacity: 0;
      transition: opacity 0.8s ease;
    }

    #resume-msg.visible {
      display: block;
      opacity: 1;
    }

    @media (max-width: 480px) {
      #resume-msg {
        font-size: 0.9rem;
        padding: 8px 16px;
      }
    }
  </style>
<link rel="stylesheet" href="" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <link href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" rel="stylesheet">
</head>
<body>
<div class="container">
<div class="main-video">
<div class="video">
<video class='js-player' poster="https://image.tmdb.org/t/p/original/wJoPsjcJkMAr7ifNqo7qlNXDzil.jpg" controls muted preload="metadata">
<source src="https://www.udrop.com/file/6goa/1x1" type="application/x-mpegURL">
</video>
<!--<video src="" poster="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR3r48KQZbrv_w2zeTpEMqrIE0BysJMnmdydw&usqp=CAU" controls muted autoplay></video>-->
<div id="resume-msg">✅ Reanudando donde lo dejaste: El juego del camalar</div>

  <div class="info">
    <i class="fal fa-calendar-alt"></i><span>2021</span>
    <i class="fal fa-clock"></i><span>T3</span>
    <i class="fal fa-thumbs-up"></i><span>70%</span>
    <div class="hd-tag">
      <svg width="22" height="22" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <rect width="24" height="24" rx="4" fill="white" />
        <text x="4" y="17" fill="black" font-size="12" font-family="Arial, sans-serif" font-style="italic" font-weight="bold">HD</text>
      </svg>
      <span>1080P</span>
    </div>
    <span>🇲🇽</span>
  </div>

  <div class="titulo">
    <h3>El juego del camalar</h3>
  </div>

  <!-- Selector de Temporadas y Botones de Episodios -->
<div style="display: flex; align-items: center; justify-content: space-between; padding: 10px; flex-wrap: wrap;">
  <div>
    <select id="temporada-select" style="background: #1c1c1c; color: white; font-size: 1rem; padding: 5px 10px; border-radius: 5px; border: 1px solid #333;">
      <option value="1" selected>Temporada 1</option>
      <option value="2">Temporada 2</option>
      <option value="3">Temporada 3</option>
    </select>
  </div>
  <div id="episodio-count" style="color: #bbb; font-size: 0.95rem;">10 Capítulos</div>
</div>

<!-- Botones de episodios -->
<div id="episodios" style="
  display: flex;
  flex-wrap: nowrap;
  gap: 10px;
  padding: 10px;
  overflow-x: auto;
  white-space: nowrap;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
"></div>

<script>
const episodiosData = {
  1: [
    { titulo: "Episodio 1 - Luz roja, luz verde", src: "https://pomf2.lain.la/f/ms1jmsqt.mp4" },
    { titulo: "Episodio 2 - INFIERNO", src: "https://pomf2.lain.la/f/qt4mljp.mp4" },
    { titulo: "Episodio 3 - El hombre del paraguas", src: "https://pomf2.lain.la/f/l6nnuimm.mp4" },
    { titulo: "Episodio 4 - No abandones el equipo", src: "https://pomf2.lain.la/f/7b498vvh.mp4" },
    { titulo: "Episodio 5 - Un mundo justo", src: "https://pomf2.lain.la/f/1qkw8fnl.mp4" },
    { titulo: "Episodio 6 - Canicas", src: "https://pomf2.lain.la/f/biuc9q09.mp4" },
    { titulo: "Episodio 7 - Los Vip", src: "https://pomf2.lain.la/f/durwx8id.mp4" },
    { titulo: "Episodio 8 - El Juego Del Calamar", src: "https://pomf2.lain.la/f/lj8wulcj.mp4" },
    { titulo: "Episodio 9 - Ultimo Juego", src: "https://pomf2.lain.la/f/4wkb714z.mp4" }
    // Agrega más si tienes
  ],
  2: [
    { titulo: "Episodio 1 - Sustento y azar", src: "https://pomf2.lain.la/f/ms26sodv.mp4" },
    { titulo: "Episodio 2 - Fiesta de Halloween", src: "https://pomf2.lain.la/f/vh3a6css.mp4" },
    { titulo: "Episodio 3 - 001", src: "https://pomf2.lain.la/f/njqor1xp.mp4" },
    { titulo: "Episodio 4 - Seis piernas", src: "https://pomf2.lain.la/f/4wbmkpbu.mp4" },
    { titulo: "Episodio 5 - Otra ronda", src: "https://dl.dropboxusercontent.com/scl/fi/pulw5k1twd035wc9dkckr/El-Juego-Del-Calamar-T2-Cap5.mp4?rlkey=wbgasljxsqaa8jz31396bjzy3&st=" },
    { titulo: "Episodio 6 - O X", src: "https://pomf2.lain.la/f/yt14iy7u.mp4" },
    { titulo: "Episodio 7 - Amigos o enemigos", src: "https://pomf2.lain.la/f/a7npytuo.mp4" }
  ],
  3: [
    { titulo: "Episodio 1 - Llaves y cuchillos", src: "https://dl.dropbox.com/scl/fi/6vque8yn2d81v084pfqwv/El-juego-del-calamar-T3-C1-2025.mp4?rlkey=yp1jrx2x4ec489c63m6nyfo82&st=" },
    { titulo: "Episodio 2 - Noche estrellada", src: "https://dl.dropbox.com/scl/fi/yknn3xevxuk43z9fdk8px/El-juego-del-calamar-T3-C2-2025.mp4?rlkey=e51mv72g3lvso172elh8tw1ts&st=" },
    { titulo: "Episodio 3 - No es culpa tuya", src: "https://dl.dropbox.com/scl/fi/ob63d7ent24jjqndac8lt/El-juego-del-calamar-T3-C3-2025.mp4?rlkey=1h841i5vpc67h6lyc4szrz1mo&st=" },
    { titulo: "Episodio 4 - 222", src: "https://dl.dropbox.com/scl/fi/k5fpwtfy4e37pmkqaw3ig/El-juego-del-calamar-T3-C4-2025.mp4?rlkey=siblgnbxzs7sj4nbqag8i5tji&st=" },
    { titulo: "Episodio 5 - ○△□", src: "https://dl.dropbox.com/scl/fi/ahh500o19r7jpz8j7fzaf/El-juego-del-calamar-T3-C5-2025.mp4?rlkey=p22znr5st1tj7ndzewi010iuz&st=" },
    { titulo: "Episodio 6 - La naturaleza humana", src: "https://dl.dropbox.com/scl/fi/0qq28soexzcb13fia17u3/El-juego-del-calamar-T3-C6-2025.mp4?rlkey=bnbwerj1jfd63vv5fcdu940c0&st=" },
    // Rellena si tienes links
  ]
};

const temporadaSelect = document.getElementById("temporada-select");
const episodiosContainer = document.getElementById("episodios");
const episodioCount = document.getElementById("episodio-count");
const mainVideo = document.querySelector('.main-video video');
const titleDiv = document.querySelector('.main-video .title');

function renderEpisodios(temporada) {
  episodiosContainer.innerHTML = "";
  
  const episodios = episodiosData[temporada] || [];
  const yearSpan = document.querySelector('.info span');
  const yearBySeason = { 1: '2021', 2: '2024', 3: '2025' };
  if (yearSpan) yearSpan.textContent = yearBySeason[temporada] || '0000';

  episodioCount.textContent = `${episodios.length} Capítulos`;

  episodios.forEach((ep, index) => {
    const btn = document.createElement("button");
    btn.textContent = index + 1;
    btn.style.cssText = `
      width: 40px; height: 40px;
      background: #222; border: none; border-radius: 5px;
      color: #ccc; font-size: 1rem; cursor: pointer;
    `;
    btn.addEventListener("click", () => {
      mainVideo.setAttribute("src", ep.src);
      mainVideo.play();
      if (titleDiv) {
        titleDiv.innerHTML = ep.titulo;
      }
    });
    episodiosContainer.appendChild(btn);
  });

  // Marcar automáticamente el primer episodio
  const firstBtn = document.querySelector('#episodios button');
  if (firstBtn) {
    firstBtn.classList.add('active');
    firstBtn.style.background = 'red';
    firstBtn.style.color = '#fff';
  }

}


// Inicializar con la temporada por defecto
renderEpisodios(temporadaSelect.value);

// Cambiar temporada
temporadaSelect.addEventListener("change", () => {
  renderEpisodios(temporadaSelect.value);
});
</script>

<script>
let currentEpisodeIndex = 0;

function renderEpisodios(temporada) {
  episodiosContainer.innerHTML = "";
  
  const episodios = episodiosData[temporada] || [];
  const yearSpan = document.querySelector('.info span');
  const yearBySeason = { 1: '2021', 2: '2024', 3: '2025' };
  if (yearSpan) yearSpan.textContent = yearBySeason[temporada] || '0000';

  episodioCount.textContent = `${episodios.length} Capítulos`;

  episodios.forEach((ep, index) => {
    const btn = document.createElement("button");
    btn.textContent = index + 1;
    btn.style.cssText = `
      width: 40px; height: 40px;
      background: #222; border: none; border-radius: 5px;
      color: #ccc; font-size: 1rem; cursor: pointer;
    `;
    btn.addEventListener("click", () => {
      playEpisode(ep.src, ep.titulo, index);
    });
    episodiosContainer.appendChild(btn);
  });

  // Marcar automáticamente el primer episodio
  const firstBtn = document.querySelector('#episodios button');
  if (firstBtn) {
    firstBtn.classList.add('active');
    firstBtn.style.background = 'red';
    firstBtn.style.color = '#fff';
  }

}

function playEpisode(src, titulo, index) {
  currentEpisodeIndex = index;
  mainVideo.src = src;
  mainVideo.load(); // prepara el video sin reproducir //
  mainVideo.pause();
mainVideo.currentTime = mainVideo.currentTime || 0; // asegúrate que se mantenga en el tiempo guardado si existe
  mainVideo.play(); // forzar reproducción automática
  if (titleDiv) titleDiv.innerHTML = titulo;

  // Desmarcar todos los botones
  const buttons = document.querySelectorAll("#episodios button");
  buttons.forEach(btn => {
    btn.classList.remove("active");
    btn.style.background = "#222";
    btn.style.color = "#ccc";
  });

  // Marcar el botón actual en rojo
  buttons[index]?.classList.add("active");
  buttons[index].style.background = "red";
  buttons[index].style.color = "#fff";

  // Reanudar si hay guardado
  const msg = document.getElementById("resume-msg");
  msg.textContent = `✅ ${titulo}`;
  msg.classList.add("visible");
  setTimeout(() => msg.classList.remove("visible"), 3000);

  localStorage.setItem("ultimo_episodio", JSON.stringify({
  temporada: temporadaSelect.value,
  index: index
}));

}



// Guardar tiempo cada 5s
setInterval(() => {
  if (!mainVideo.paused && !mainVideo.ended) {
    localStorage.setItem(`resume_${temporadaSelect.value}_${currentEpisodeIndex}`, mainVideo.currentTime);
  }
}, 5000);


mainVideo.addEventListener("pause", () => {
  if (autoNextPlaying && !mainVideo.ended) {
    mainVideo.play();
    autoNextPlaying = false;
  }
});


// Auto-next al finalizar
mainVideo.addEventListener("ended", () => {
  mainVideo.currentTime = 0;
  const episodios = episodiosData[temporadaSelect.value] || [];
  if (currentEpisodeIndex + 1 < episodios.length) {
    const next = episodios[currentEpisodeIndex + 1];
    playEpisode(next.src, next.titulo, currentEpisodeIndex + 1);
  }
});

// Re-render al cambiar temporada
temporadaSelect.addEventListener("change", () => {
  // Detener y reiniciar el video
  mainVideo.pause();
  mainVideo.removeAttribute("src");
  mainVideo.load(); // reinicia el reproductor
});
// Limpiar título
  if (titleDiv) titleDiv.innerHTML = "Selecciona un episodio";
  // Limpiar botones marcados
  document.querySelectorAll("#episodios button").forEach(btn => {
    btn.classList.remove("active");
    btn.style.background = "#222";
    btn.style.color = "#ccc";
  });

  


// Inicial
const ultimo = JSON.parse(localStorage.getItem("ultimo_episodio") || "null");

if (ultimo && episodiosData[ultimo.temporada]) {
  temporadaSelect.value = ultimo.temporada;
  renderEpisodios(ultimo.temporada);
  const ep = episodiosData[ultimo.temporada][ultimo.index];
  if (ep) {
    currentEpisodeIndex = ultimo.index;
    mainVideo.src = ep.src;
    mainVideo.load(); // carga sin reproducir
    mainVideo.pause();
    if (titleDiv) titleDiv.innerHTML = ep.titulo;

    const buttons = document.querySelectorAll("#episodios button");
    buttons.forEach(btn => {
      btn.classList.remove("active");
      btn.style.background = "#222";
      btn.style.color = "#ccc";
    });
    buttons[ultimo.index]?.classList.add("active");
    buttons[ultimo.index].style.background = "red";
    buttons[ultimo.index].style.color = "#fff";

    const msg = document.getElementById("resume-msg");
    msg.textContent = `✅ ${ep.titulo} cargado`;
    msg.classList.add("visible");
    setTimeout(() => msg.classList.remove("visible"), 3000);
  }
} else {
  renderEpisodios(temporadaSelect.value);
  const ep = episodiosData[temporadaSelect.value][0];
  mainVideo.src = ep.src;
  mainVideo.load();
  mainVideo.pause();
  if (titleDiv) titleDiv.innerHTML = ep.titulo;

  const buttons = document.querySelectorAll("#episodios button");
  buttons[0]?.classList.add("active");
  buttons[0].style.background = "red";
  buttons[0].style.color = "#fff";
}


</script>

<style>
  #episodios button {
    min-width: 40px;
    height: 40px;
    flex: 0 0 auto;
    scroll-snap-align: start;
  }
  #episodios button.active {
  background: red !important;
  color: white !important;
  #episodios button {
  scroll-snap-align: start;
  flex: 0 0 auto;
}
#episodios::-webkit-scrollbar {
  height: 6px;
}
#episodios::-webkit-scrollbar-thumb {
  background: #888;
  border-radius: 5px;
}
#episodios::-webkit-scrollbar-track {
  background: #111;
}
}

</style>

<br>
<div class="titulo">
  <h4>Género: Acción, Misterio, Drama, Terror</h4>
</div>


  <div class="sinopsis">
    <h4>Sinopsis:</h4>
    <p>
      Cientos de personas con problemas de dinero aceptan una invitación rarísima para competir en juegos infantiles. Dentro los esperan un tentador premio y desafíos letales.
    </p>
  </div>
  <div style="text-align: center; margin-top: 15px;">
    <button id="btn-favorito" style="
      background: #ff4444;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 20px;
      font-size: 1rem;
      cursor: pointer;
    ">
      ⭐ Favoritos
    </button>
  </div>
  <br>

<br>
<div class="recomendaciones">
  <h4>Podría interesarte:</h4>
  <br>
  <div class="series-grid">
    <a href="#" class="serie">
      <img loading="lazy" src="https://image.tmdb.org/t/p/w300/" alt="">
      <p>Nombre de Serie</p>
    </a>
    <a href="#" class="serie">
      <img loading="lazy" src="https://image.tmdb.org/t/p/w300/" alt="">
      <p>Nombre de Serie</p>
    </a>
    <a href="#" class="serie">
      <img loading="lazy" src="https://image.tmdb.org/t/p/w300/" alt="">
      <p>Nombre de Serie</p>
    </a>
    <a href="#" class="serie">
      <img loading="lazy" src="https://image.tmdb.org/t/p/w300/" alt="">
      <p>Nombre de Serie</p>
    </a>
    <a href="#" class="serie">
      <img loading="lazy" src="https://image.tmdb.org/t/p/w300/" alt="">
      <p>Nombre de Serie</p>
    </a>
    <a href="#" class="serie">
      <img loading="lazy" src="https://image.tmdb.org/t/p/w300/" alt="">
      <p>Nombre de Serie</p>
    </a>
  </div>
</div>
<br>
<!-- Historial -->

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const serieTitulo = "El juego del calamar";
    const serieImagen = "https://image.tmdb.org/t/p/w300/xNvlt4jn2KbuKJoZ9UiVpm7lYjr.jpg";
    const archivoHTML = "../View Series/El Juego Del Calamar (2021).html"; // ✅ Ruta relativa al historial
    

    let historial = JSON.parse(localStorage.getItem('historial_usuarios') || '[]');
    const index = historial.findIndex(h => h.titulo === serieTitulo);

    if (index === -1) {
      historial.unshift({
        titulo: serieTitulo,
        imagen: serieImagen,
        progreso: progresoTexto,
        archivo: archivoHTML,
        timestamp: Date.now() // ✅ IMPORTANTE
      });
      if (historial.length > 20) historial.pop(); // Limita a 20
    } else {
      historial[index].progreso = progresoTexto;
      historial[index].timestamp = Date.now(); // ✅ Actualiza orden
    }

    localStorage.setItem('historial_usuarios', JSON.stringify(historial));
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const mainVideo = document.querySelector('.main-video video');
    const titleDiv = document.querySelector('.main-video .title');
    const temporadaSelect = document.getElementById('temporada-select');

    const serieTitulo = "El juego del calamar";
    const serieImagen = "https://image.tmdb.org/t/p/w300/xNvlt4jn2KbuKJoZ9UiVpm7lYjr.jpg";
    const archivoHTML = "../View Series/El Juego Del Calamar (2021).html";

    function guardarEnHistorial(epTitulo, temporada, episodioIndex) {
      let historial = JSON.parse(localStorage.getItem('historial_usuarios') || '[]');
      const registro = historial.find(h => h.titulo === serieTitulo);
      const progresoTexto = `T${temporada} • Episodio ${episodioIndex + 1} - ${epTitulo}`;

      if (!registro) {
        historial.push({
          titulo: serieTitulo,
          imagen: serieImagen,
          progreso: progresoTexto,
          archivo: archivoHTML
        });
        mostrarMensaje("📺 Agregado al historial");
      } else {
        registro.progreso = progresoTexto;
      }
      localStorage.setItem('historial_usuarios', JSON.stringify(historial));
    }

    function mostrarMensaje(texto) {
      let mensaje = document.getElementById('mensaje-confirmacion');
      if (!mensaje) {
        mensaje = document.createElement('div');
        mensaje.id = 'mensaje-confirmacion';
        mensaje.style.cssText = `
          position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
          background: rgba(0,0,0,0.85); color: #fff; padding: 12px 24px;
          border-radius: 8px; font-size: 1rem; z-index: 9999;
          box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
        `;
        document.body.appendChild(mensaje);
      }
      mensaje.textContent = texto;
      mensaje.style.display = 'block';
      mensaje.style.opacity = '1';
      setTimeout(() => {
        mensaje.style.opacity = '0';
        setTimeout(() => mensaje.style.display = 'none', 500);
      }, 3000);
    }

    window.guardarEnHistorial = guardarEnHistorial;

    mainVideo.addEventListener('play', () => {
      if (titleDiv?.innerText) {
        const temporada = temporadaSelect?.value || '1';
        const index = Array.from(document.querySelectorAll('#episodios button')).findIndex(btn => btn.classList.contains('active'));
        guardarEnHistorial(titleDiv.innerText, temporada, index);
      }
    });
  });
</script>


<!-- FAVORITOS -->
<script>
document.getElementById('btn-favorito').addEventListener('click', () => {
  const nuevaPelicula = {
    titulo: "El juego del calamar",
    imagen: "https://image.tmdb.org/t/p/w300/xNvlt4jn2KbuKJoZ9UiVpm7lYjr.jpg",
    genero: "Crimen/Serie",
    archivo: "../View Series/El Juego Del Calamar (2021).html"
  };
  let favoritos = JSON.parse(localStorage.getItem('favoritos_detalles') || '[]');
  if (!favoritos.some(f => f.titulo === nuevaPelicula.titulo)) {
    favoritos.push(nuevaPelicula);
    localStorage.setItem('favoritos_detalles', JSON.stringify(favoritos));
  }
  window.location.href = "../View Peliculas/favoritos.html";
});
</script>


<!-- Añadir Botones para .js-player: Reinicio al inicio (fa-step-backward), Retroceso (fa-undo) y Avance (fa-forward) -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll('.js-player').forEach(video => {
    const controls = video.closest('.main-video')?.querySelector('.plyr__controls');
    if (controls && !controls.querySelector('#plyr-restart')) {
      // 1️⃣ Crear botón de Reinicio al inicio (#plyr-restart) al EXTREMO IZQUIERDO
      const restartBtn = document.createElement("button");
      restartBtn.className = "plyr__control";
      restartBtn.id = "plyr-restart";
      restartBtn.innerHTML = '<i class="fas fa-undo"></i><span class="plyr__sr-only">Reiniciar al inicio</span>';
      restartBtn.title = "Reiniciar al inicio (0s)";
      restartBtn.addEventListener("click", () => {
        video.currentTime = 0;
      });
      controls.insertBefore(restartBtn, controls.firstChild);

      // 2️⃣ Crear botón de Retroceso (#plyr-rewind) junto al de Reinicio
      const rewindBtn = document.createElement("button");
      rewindBtn.className = "plyr__control";
      rewindBtn.id = "plyr-rewind";
      rewindBtn.innerHTML = '<i class="fas fa-step-backward"></i><span class="plyr__sr-only">Retroceder 10 segundos</span>';
      rewindBtn.title = "Retroceder 10s";
      rewindBtn.addEventListener("click", () => {
        video.currentTime = Math.max(video.currentTime - 10, 0);
      });
      controls.insertBefore(rewindBtn, restartBtn.nextSibling);

      // 3️⃣ Crear botón de Avance (#plyr-fast-forward) estándar de Plyr
      const forwardBtn = document.createElement("button");
      forwardBtn.className = "plyr__control";
      forwardBtn.id = "plyr-fast-forward";
      forwardBtn.innerHTML = '<i class="fa fa-forward"></i><span class="plyr__sr-only">Avanzar 10 segundos</span>';
      forwardBtn.title = "Avanzar 10s";

      const playButton = controls.querySelector('.plyr__control[data-plyr="play"]');
      if (playButton) {
        playButton.after(forwardBtn);
      } else {
        controls.appendChild(forwardBtn);
      }

      forwardBtn.addEventListener("click", () => {
        video.currentTime = Math.min(video.currentTime + 10, video.duration);
      });
    }
  });
});
</script>



<!-- Lógica para guardar posición y mostrar mensaje de reanudación por episodio -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const mainVideo = document.querySelector('.main-video video');
  const resumeMsg = document.getElementById('resume-msg');
  let currentEpisode = null;

  // Al hacer clic en un episodio
  document.querySelectorAll('.video-list .vid').forEach(videoItem => {
    videoItem.addEventListener('click', e => {
      // Identificamos el episodio por posición en la lista
      const episodeIndex = Array.from(document.querySelectorAll('.video-list .vid')).indexOf(videoItem);
      currentEpisode = episodeIndex;

      // Cambiamos la fuente del video
      const src = videoItem.querySelector('video').getAttribute('src');
      mainVideo.setAttribute('src', src);

      // Checamos si existe posición guardada para este episodio
      const savedTime = localStorage.getItem(`pos_episodio_${episodeIndex}`);
      if (savedTime && parseFloat(savedTime) > 10) {
        mainVideo.currentTime = parseFloat(savedTime);
        resumeMsg.textContent = `✅ Reanudando ${videoItem.querySelector('.title').textContent.trim()} donde lo dejaste`;
        resumeMsg.classList.add('visible');
        setTimeout(() => {
          resumeMsg.classList.remove('visible');
        }, 3000);
      }
    });
  });

  // Guardamos posición cada 5 seg para cada episodio activo
  setInterval(() => {
    if (!mainVideo.paused && !mainVideo.ended && currentEpisode !== null) {
      localStorage.setItem(`pos_episodio_${currentEpisode}`, mainVideo.currentTime);
    }
  }, 5000);
});
</script>


<!-- ACELERAR VIDEO -->
<script>
const videoList = document.querySelectorAll('.video-list .vid');
const mainVideo = document.querySelector('.main-video video');

videoList.forEach(videoItem => {
  videoItem.addEventListener('click', e => {
    videoList.forEach(v => v.classList.remove('active'));
    videoItem.classList.add('active');

    const videoSrc = videoItem.getAttribute('data-url');
    mainVideo.setAttribute('src', videoSrc);
    mainVideo.play();
  });
});
</script>





</script>

<!-- partial -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
<script type="text/javascript">
let listVideo = document.querySelectorAll('.video-list .vid');
let mainVideo = document.querySelector('.main-video video');
let title = document.querySelector('.main-video .title');

listVideo.forEach(video =>{
  video.onclick = () =>{
    listVideo.forEach(vid => vid.classList.remove('active'));
    video.classList.add('active');
    if(video.classList.contains('active')){
      let src = video.children[0].getAttribute('src');
      mainVideo.src = src;
      let text = video.children[1].innerHTML;
      title.innerHTML = text;
    };
  };
});
</script>
<script src="https://cdn.plyr.io/3.6.12/plyr.js"></script>
<script>//<![CDATA[
const players = Array.from(document.querySelectorAll('.js-player')).map(player => new Plyr(player));
//]]></script>
</body>
</html>